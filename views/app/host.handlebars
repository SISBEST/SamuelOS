<div id="editor">
	
</div>
<script src="https://pagecdn.io/lib/ace/1.4.12/ace.min.js"></script>
<script>
	fetch('/public').then(function(response) {
		return response.text();
	}).then(function(pgdata) {
		ace.config.set('basePath', 'https://pagecdn.io/lib/ace/1.4.12/');
		var editor = ace.edit("editor");
		editor.setTheme("ace/theme/monokai");
		editor.session.setMode('ace/mode/html');
		editor.setValue(pgdata);
		setInterval(function() {
			fetch('/public?pass={{pass}}', {
				method: 'post',
				body: editor.getValue()
			}).then(function(response) {
				return response.text();
			}).then(function(data) {
				if (data !== "OK") {
					alert("An error occured while saving your public code. Copy your work and try again.");
				}
			});
		}, 5000);
	});
</script>